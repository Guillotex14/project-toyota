<ion-content [fullscreen]="true">
  <ion-grid fixed>
    <ion-row>

      <ion-col size="12" class="header">
          <ion-row>
            <ion-col size="2">
              <ion-icon name="arrow-back-circle-sharp" style="color: white; font-size: 40px; margin: auto;margin-top: 35px;" (click)="goBack()"></ion-icon>
            </ion-col>
            <ion-col size="8" style="text-align: center;">
              <ion-img src="assets/images/logo/logo_toyota.png" style="width: 70px;height: 70px; margin: 15px auto auto auto;"></ion-img>
            </ion-col>
            <ion-col size="2">
              <ion-icon name="menu-outline" style="color: white; font-size: 40px; margin: auto;margin-top: 35px;" (click)="openMenu()"></ion-icon>
            </ion-col>
          </ion-row>
      </ion-col>

      <ion-col size="12">
        <ion-card class="cardChart">
          <ion-card-content >
            <canvas #lineCanvas style="position: relative; height:20vh!important; width:40vw!important"></canvas>
          </ion-card-content>
        </ion-card>
      </ion-col>
      

      <ion-col size="12">
        <ion-button expand="block" shape="round" class="btnRed" id="open-filter" style="width: 90% !important; margin: auto !important;">
          filtro
        </ion-button>
      </ion-col>

      <ion-col size="12" style="margin-top: 50px !important;">
        <ion-list-header class="headerList">
          <ion-button (click)="exportExcel()" expand="block" shape="round" class="btnRed" id="">Exportar</ion-button>
          <ion-label style="font-size: 18px; color: black; font-weight: 600;">Lista de vehiculos</ion-label>
          <ion-button expand="block" shape="round" class="btnRed" id="openFilterVehicles">Filtro</ion-button>
        </ion-list-header>
        <ion-list *ngFor="let modelCar of arrayListCars">
          <ion-item-divider >
            <ion-label style="font-size: 18px;color: black;font-weight: 600;">{{modelCar._id}}</ion-label>
          </ion-item-divider>
          <ion-item>
            <ion-col size="4" style="text-align: center !important;">
              <ion-label style="font-size: 15px;color: black;font-weight: 600;">Precio Max.</ion-label>
              <ion-label style="font-size: 16px;color: black;font-weight: 600;">${{modelCar.maxPrice ? modelCar.maxPrice : 0}}</ion-label>
            </ion-col>
            <ion-col size="4" style="text-align: center !important;">
              <ion-label style="font-size: 15px;color: black;font-weight: 600;">Precio Prom.</ion-label>
              <ion-label style="font-size: 16px;color: black;font-weight: 600;">${{modelCar.avgPrice ? modelCar.avgPrice : 0}}</ion-label>
            </ion-col>
            <ion-col size="4" style="text-align: center !important;">
              <ion-label style="font-size: 15px;color: black;font-weight: 600;">Precio Min.</ion-label>
              <ion-label style="font-size: 16px;color: black;font-weight: 600;">${{modelCar.minPrice ? modelCar.minPrice : 0}}</ion-label>
            </ion-col>
          </ion-item>
          
          <ion-item *ngFor="let vehicle of modelCar.vehicles">
            <ion-card (click)="detailCar(vehicle._id)">
              <ion-card-content>
                <ion-grid fixed>
                  <ion-row>
                    <ion-col size="4">
                      <ion-img src="assets/images/carro/toyota1.png"></ion-img>
                    </ion-col>
                    <ion-col size="8">
                      <ion-row>
                        <ion-col size="12">
                          <ion-card-title style="font-weight: bold;">{{vehicle.model}}</ion-card-title>
                          <ion-card-subtitle style="font-size: 13px;font-weight: 600;color: black;">Vendida en <br>{{vehicle.city}}</ion-card-subtitle>
                        </ion-col>
                        <ion-col size="12" style="text-align: center !important;">
                          <ion-row>
                            <ion-col size="7">
                              <ion-card-subtitle style="color: black; font-weight: 600; font-size: 13px;">
                                {{vehicle.date_sell}}
                              </ion-card-subtitle>
                            </ion-col>
                            <ion-col size="5">
                              <ion-card-title style="font-weight: bold; color: green; font-size: 15px;">
                                <!-- {{vehicle.price | currency:'USD':true:'1.0-0'}} -->
                                ${{vehicle.price ? vehicle.price : 0}}
                              </ion-card-title>
                            </ion-col>
                          </ion-row>
                        </ion-col>
                      </ion-row>
                    </ion-col>
                  </ion-row>
                </ion-grid>
              </ion-card-content>
            </ion-card>
          </ion-item>

        </ion-list>
        
      </ion-col>
    </ion-row>
  </ion-grid>

  <ion-modal trigger="open-filter">
    <ng-template>
      <ion-header>
        <ion-toolbar>
          <ion-buttons slot="start">
            <ion-button color="medium" (click)="closeModal()" [strong]="true">Cancelar</ion-button>
          </ion-buttons>
          <ion-title>Opciones filtro</ion-title>
          <ion-buttons slot="end">
            <ion-button [strong]="true" (click)="applyFilter()">Filtrar</ion-button>
          </ion-buttons>
        </ion-toolbar>
      </ion-header>
      
      <ion-content class="ion-padding">
        <ion-accordion-group expand="inset" [value]="['brand']">

          <ion-accordion value="brand">
            <ion-item slot="header">
              <ion-label>Marca</ion-label>
            </ion-item>
            <div class="ion-padding" slot="content">
              <ion-list>
                <ion-radio-group [(ngModel)]="brandCar">
                    <ion-item>
                      <ion-label>Todos</ion-label>
                      <ion-radio value=""></ion-radio>
                    </ion-item>
                  <ion-item *ngFor="let brand of arrayBrands">
                    <ion-label>{{brand.name}}</ion-label>
                    <ion-radio [value]="brand.name"></ion-radio>
                  </ion-item>
                </ion-radio-group>
              </ion-list>
            </div>
          </ion-accordion>
      
          <ion-accordion value="model">
            <ion-item slot="header">
              <ion-label>Modelo</ion-label>
            </ion-item>
            <div class="ion-padding" slot="content">
              <ion-list>
                <ion-radio-group [(ngModel)]="modelCar">
                  <ion-item>
                    <ion-label>Todos</ion-label>
                    <ion-radio value=""></ion-radio>
                  </ion-item>
                  <ion-item *ngFor="let model of arrayModels">
                    <ion-label>{{model.model}}</ion-label>
                    <ion-radio [value]="model.model"></ion-radio>
                  </ion-item>
                </ion-radio-group>
              </ion-list>
            </div>
          </ion-accordion>
          
          <ion-accordion value="year_vehicle">
            <ion-item slot="header">
              <ion-label>A単o del vehiculo</ion-label>
            </ion-item>
            <div class="ion-padding" slot="content">
              <ion-list>
                <ion-item>
                  <ion-input label="A単o" labelPlacement="stacked" (ionInput)="dotMinYear($event.target)" [value]="yearCarAux"></ion-input>
                </ion-item>
              </ion-list>
            </div>
          </ion-accordion>

          <ion-accordion value="month_range">
            <ion-item slot="header">
              <ion-label>Rango de meses</ion-label>
            </ion-item>
            <div class="ion-padding" slot="content">
              <ion-list>
                <ion-radio-group [(ngModel)]="rangMonths">
                  <ion-item>
                    <ion-label>12 meses</ion-label>
                    <ion-radio [value]="12"></ion-radio>
                  </ion-item>
                  <ion-item>
                    <ion-label>6 meses</ion-label>
                    <ion-radio [value]="6"></ion-radio>
                  </ion-item>
                  <ion-item>
                    <ion-label>3 meses</ion-label>
                    <ion-radio [value]="3"></ion-radio>
                  </ion-item>
                  <ion-item>
                    <ion-label>1 mes</ion-label>
                    <ion-radio [value]="1"></ion-radio>
                  </ion-item>
                </ion-radio-group>
              </ion-list>
            </div>
          </ion-accordion>

          <ion-accordion value="month">
            <ion-item slot="header">
              <ion-label>Por mes</ion-label>
            </ion-item>
            <div class="ion-padding" slot="content">
              <ion-list>
                <ion-radio-group [(ngModel)]="month">
                  <ion-item>
                    <ion-label>Enero</ion-label>
                    <ion-radio [value]="1"></ion-radio>
                  </ion-item>
                  <ion-item>
                    <ion-label>Febrero</ion-label>
                    <ion-radio [value]="2"></ion-radio>
                  </ion-item>
                  <ion-item>
                    <ion-label>Marzo</ion-label>
                    <ion-radio [value]="3"></ion-radio>
                  </ion-item>
                  <ion-item>
                    <ion-label>Abril</ion-label>
                    <ion-radio [value]="4"></ion-radio>
                  </ion-item>
                  <ion-item>
                    <ion-label>Mayo</ion-label>
                    <ion-radio [value]="5"></ion-radio>
                  </ion-item>
                  <ion-item>
                    <ion-label>Junio</ion-label>
                    <ion-radio [value]="6"></ion-radio>
                  </ion-item>
                  <ion-item>
                    <ion-label>Julio</ion-label>
                    <ion-radio [value]="7"></ion-radio>
                  </ion-item>
                  <ion-item>
                    <ion-label>Agosto</ion-label>
                    <ion-radio [value]="8"></ion-radio>
                  </ion-item>
                  <ion-item>
                    <ion-label>Septiembre</ion-label>
                    <ion-radio [value]="9"></ion-radio>
                  </ion-item>
                  <ion-item>
                    <ion-label>Octubre</ion-label>
                    <ion-radio [value]="10"></ion-radio>
                  </ion-item>
                  <ion-item>
                    <ion-label>Noviembre</ion-label>
                    <ion-radio [value]="11"></ion-radio>
                  </ion-item>
                  <ion-item>
                    <ion-label>Diciembre</ion-label>
                    <ion-radio [value]="12"></ion-radio>
                  </ion-item>
                </ion-radio-group>
              </ion-list>
            </div>
          </ion-accordion>

        </ion-accordion-group>
      
      </ion-content>
    </ng-template>
  </ion-modal>

  <ion-modal trigger="openFilterVehicles" #ModalFilterVehicle>
    <ng-template>
      <ion-header>
        <ion-toolbar>
          <ion-buttons slot="start">
            <ion-button color="medium" (click)="closeModal2()" [strong]="true">Cancelar</ion-button>
          </ion-buttons>
          <ion-title>Opciones filtro</ion-title>
          <ion-buttons slot="end">
            <ion-button [strong]="true" (click)="applyFilter2()">Filtrar</ion-button>
          </ion-buttons>
        </ion-toolbar>
      </ion-header>
      
      <ion-content class="ion-padding">
        <ion-accordion-group expand="inset" [value]="['brand']">

          <ion-accordion value="brand">
            <ion-item slot="header">
              <ion-label>Marca</ion-label>
            </ion-item>
            <div class="ion-padding" slot="content">
              <ion-list>
                <ion-radio-group [(ngModel)]="brandCar2">
                    <ion-item>
                      <ion-label>Todos</ion-label>
                      <ion-radio value=""></ion-radio>
                    </ion-item>
                  <ion-item *ngFor="let brand of arrayBrands">
                    <ion-label>{{brand.name}}</ion-label>
                    <ion-radio [value]="brand.name"></ion-radio>
                  </ion-item>
                </ion-radio-group>
              </ion-list>
            </div>
          </ion-accordion>
      
          <ion-accordion value="model">
            <ion-item slot="header">
              <ion-label>Modelo</ion-label>
            </ion-item>
            <div class="ion-padding" slot="content">
              <ion-list>
                <ion-radio-group [(ngModel)]="modelCar2">
                  <ion-item>
                    <ion-label>Todos</ion-label>
                    <ion-radio value=""></ion-radio>
                  </ion-item>
                  <ion-item *ngFor="let model of arrayModels">
                    <ion-label>{{model.model}}</ion-label>
                    <ion-radio [value]="model.model"></ion-radio>
                  </ion-item>
                </ion-radio-group>
              </ion-list>
            </div>
          </ion-accordion>
          
          <ion-accordion value="year_vehicle">
            <ion-item slot="header">
              <ion-label>A単o del vehiculo</ion-label>
            </ion-item>
            <div class="ion-padding" slot="content">
              <ion-list>
                <ion-item>
                  <ion-input label="A単o" labelPlacement="stacked" (ionInput)="dotMinYear2($event.target)" [value]="yearCarAux2"></ion-input>
                </ion-item>
              </ion-list>
            </div>
          </ion-accordion>

          <ion-accordion value="date_range">
            <ion-item slot="header">
              <ion-label>Rango de fecha</ion-label>
            </ion-item>
            <div class="ion-padding" slot="content">
              <ion-list>
                <ion-item>
                  <ion-label>Desde</ion-label>
                  <ion-datetime displayFormat="YYYY-MM-DD" [(ngModel)]="dateFrom" presentation="date" [value]="today" (ionChange)="onDateFromChange($event)"></ion-datetime>
                </ion-item>
                <ion-item>
                  <ion-label>Desde</ion-label>
                  <ion-datetime displayFormat="YYYY-MM-DD" [(ngModel)]="dateTo" presentation="date" [value]="today" (ionChange)="onDateToChange($event)"></ion-datetime>
                </ion-item>
              </ion-list>
            </div>
          </ion-accordion>

        </ion-accordion-group>
      
      </ion-content>
    </ng-template>
  </ion-modal>
</ion-content>

